name: mcp-secrets-list
description: Agent should use MCP secrets tool when asked about stored secrets
type: tool_selection
agent: pm-assistant

input:
  prompt: 'Can you list the secrets configured in Orient? Just show me the names/keys.'

mocks:
  orient-assistant:
    list_secrets:
      response:
        secrets:
          - key: OPENAI_API_KEY
            category: api_keys
          - key: SLACK_BOT_TOKEN
            category: integrations
          - key: ANTHROPIC_API_KEY
            category: api_keys

expect:
  tool_calls:
    required:
      - name: list_secrets

  assertions:
    # Response should list secret names
    - type: response_matches
      pattern: 'OPENAI|SLACK|ANTHROPIC|api.*key'
    # Should NOT reveal actual secret values
    - type: response_not_matches
      pattern: 'sk-ant-|sk-proj-|xoxb-'
