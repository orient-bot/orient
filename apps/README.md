# Mini-Apps

This directory contains AI-generated React applications ("Mini-Apps") that can be shared with users via secret links.

## Directory Structure

```
apps/
├── README.md                    # This file
├── _shared/                     # Shared components and utilities
│   ├── ui/                      # UI component library (design system)
│   └── hooks/                   # Shared React hooks
├── meeting-scheduler/           # Example app
│   ├── APP.yaml                 # App manifest
│   ├── src/
│   │   └── App.tsx              # Main component
│   └── dist/                    # Built output (generated by CI)
└── ...
```

## Creating a New App

Apps are created by the AI agent in response to user requests. The workflow is:

1. **User Request**: "Create an app to schedule meetings"
2. **AI Generation**: Agent generates APP.yaml + src/App.tsx
3. **PR Creation**: App is submitted as a pull request
4. **CI Build**: GitHub Actions builds the app
5. **Deployment**: After PR merge, app is deployed

## APP.yaml Manifest

Every app requires an `APP.yaml` manifest file:

```yaml
name: meeting-scheduler
version: 1.0.0
title: Meeting Scheduler
description: Allow users to select a time slot and schedule a meeting

# Tool permissions
permissions:
  calendar:
    read: true
    write: true
  slack:
    read: false
    write: true

# Built-in capabilities
capabilities:
  scheduler:
    enabled: true
    max_jobs: 5
  webhooks:
    enabled: false

# Sharing configuration
sharing:
  mode: secret_link
  expires_after_days: 30

# Build configuration
build:
  entry: src/App.tsx
  output: dist/
```

## Permission Categories

| Category   | Description             | Tools Included                |
| ---------- | ----------------------- | ----------------------------- |
| `calendar` | Google Calendar access  | List/create/update events     |
| `slack`    | Slack messaging         | Send DMs and channel messages |
| `jira`     | JIRA issue management   | Query and update issues       |
| `google`   | Google account services | Gmail, Tasks                  |
| `docs`     | Document services       | Slides, Sheets                |

## Built-in Capabilities

### Scheduler

Apps can create scheduled jobs (reminders, notifications):

```tsx
import { bridge } from '@orient/app-runtime';

await bridge.scheduler.createJob({
  name: 'reminder',
  scheduleType: 'once',
  runAt: new Date(Date.now() + 15 * 60 * 1000),
  provider: 'slack',
  target: '#team',
  messageTemplate: 'Meeting in 15 minutes!',
});
```

### Webhooks

Apps can register webhook endpoints:

```tsx
import { bridge } from '@orient/app-runtime';

const webhookUrl = await bridge.webhooks.getEndpointUrl('form-submit');
// Use this URL in external forms
```

## Design System

All apps must follow the design system defined in `/docs/FRONTEND_DESIGN_SYSTEM.md`:

- Use semantic color tokens (`bg-background`, `text-foreground`)
- Use the font system (`font-sans` for UI, `font-mono` for data)
- Follow component patterns for buttons, cards, inputs

## Shared Components

The `_shared/` directory contains reusable components:

```tsx
import { Button, Card, DatePicker } from '../_shared/ui';
import { useBridge } from '../_shared/hooks';
```

## Development

To test an app locally:

```bash
# Navigate to app directory
cd apps/meeting-scheduler

# Install dependencies
npm install

# Start dev server
npm run dev
```

## Security

- Apps run in sandboxed iframes with strict CSP
- Tool access is controlled by APP.yaml permissions
- All tool calls are logged for audit
- Share tokens can be rate-limited and expired
